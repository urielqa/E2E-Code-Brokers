/*! SheetJS (C) http://sheetjs.com */
// Simulação mínima para exportação XLSX (apenas para demo, substitua pelo oficial em produção)
window.XLSX = {
  utils: {
    aoa_to_sheet: function(data) {
      return { data: data };
    },
    book_new: function() {
      return { Sheets: {}, SheetNames: [] };
    },
    book_append_sheet: function(wb, ws, name) {
      wb.Sheets[name] = ws;
      wb.SheetNames.push(name);
    }
  },
  writeFile: function(wb, filename) {
    // Apenas salva como CSV para demo (substitua pelo SheetJS real para XLSX)
    var csv = wb.Sheets[wb.SheetNames[0]].data.map(r => r.join(",")).join("\n");
    var blob = new Blob([csv], {type: 'text/csv'});
    var a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = filename.replace(/\.xlsx$/, '.csv');
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  }
};
